作者：博士脑洞大的很
链接：https://www.zhihu.com/question/25059001/answer/106676021
来源：知乎
著作权归作者所有。商业转载请联系作者获得授权，非商业转载请注明出处。



最近不少人询问一些关于bilevel的问题，我的直观感觉是大家可能不是不明白bilevel，而是不太明白自己做的模型。如果是交通领域做这块的话，很大程度上是网络分配作为下层。如果感觉公式表达看不太懂的话，我建议大家翻看sheffi的《Urban transportation networks》这本书，是我认为网络入门最好的书籍没有之一。如果觉得英文版的吸收困难，黄海军老师翻译过中文《城市交通网络平衡分析:理论与实践》。另外如果是对于bilevel构建的形式或者发展的情况不太了解的，我推荐15年《Bilevel Programming Problems》这本，再者如果有想从基础系统学期的话，《Foundations of Bilevel Programming》应该是很经典了。

BILEVEL问题，建模不简单，但是解法更难，从某些层面来说，许多解法都是case specific的，换句话适用性不会很强。因此，这方面的问题，我建议参考论文，有针对性的进行研究，书籍的话优化实在范围太广，学起来可能不是三两月能明白的事情。



---------------------------原回答------------------------------

深夜失眠，扫到这个问题，谈下自己的理解。解决双层规划，首先要搞明白俩个事情，一是为什么要双层规划?二是如何求解?

广义上来说，双层规划就是下层函数的解是上层函数的计算参数，但这个定义不准确，因为任何最优化问题其实都可以理解成是双层规划，只要将自变量理解为无约束的规划即可，那么问题就是如何判断一个问题是一个双层问题呢?

方法很简单，就是看下层的自变量与上层模型的关系能否用解析式表达出来，如果能，那么就可以直接表达成一个约束做成单层函数求解，如果不能就是双层问题了。

一般能写成单层尽量不要双层，因为optimal solution很难保证，往往只能得到strong stationary solution，而且求解过程很复杂。一个特殊的情况就是变分不等式，由于变分不等式往往是不等式组，作为单层约束来看也非常难解，所以可以考虑写成双层问题。

如果明确了双层规划的内涵，就可以很好的选择方法了，基本上分为两大类：

解析法和启发式算法：

解析法就是直接算出解析节，这种方法的逻辑大都使用KKT，对偶，罚函数等将双层规划转化成单层，然后利用单层的方法求解。另一种启发式算法(也有类启发式，就是解析和启发的结合)，

启发式算法:

有方向的迭代，一般来说给一个初始可行解然后按照实际问题确定一个下降方向，不断搜索直到gap满足精度要求，但这里必须注意，启发式算法很有可能得到的不是最优解，一定要对结果进行论证。除搜索法外，启发式算法中，还有包括active-set，trust region等方法，更有特色，也各有前提，需要实际问题实际分析。

题主提到了非线性的条件，非线性确实是双层规划中最难的问题，目前许多方法也颇受争议，主要的问题是无法确定集的凹凸性，就使得很多解法不能适用。当然，对于一些问题还是有迹可循的，例如函数和约束都可导的话可以结合sqp将原问题近似为二次问题，然后进一步求解。再不济可以用分段线性拟合，将原问题转化成线性问题，不过这些方法虽然适用性还可以但是收敛性特征却很不明显导致迭代次数较大，计算容量不够。

最后就是不知道题主的实际问题，有些问题其实可以直接用GAMS等平台solver解的，算法也比较成熟，可以考虑。



### GAN



**不建议用博弈论思想(game theory)去理解对抗网络**，减弱生成器G 与判别器D 间的对抗属性有利于稳定训练。

**不要把判别器理解成一个分类器**(Discriminator, Classifier)，让判别器回归判别属性，像Critic 那样输出一个评分。这样能让判别器为生成器提供更良好的优化梯度。

神经网络A可以用标好的数据去训练，这是单层优化。若数据没有被标记，我也可以训练网络B对数据进行标记，之后网络A可以在B的协助下进行训练，这是双层优化 

**网络的生成器G判别器D就是A与B，强化学习的Actor-Critic也是A与B**。这两个领域的一些方法可通用。

